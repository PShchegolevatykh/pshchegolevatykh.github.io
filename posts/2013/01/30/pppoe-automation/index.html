<!DOCTYPE html>
<html>
    <head>
        <!--Import Google Icon Font-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <!--Import materialize.css-->
        <link type="text/css" rel="stylesheet" href="../../../../../css/materialize.min.css"  media="screen,projection"/>
        <link type="text/css" rel="stylesheet" href="../../../../../css/style.css" media="screen,projection">
        <link type="text/css" rel="stylesheet" href="../../../../../css/prism.css" media="screen,projection">
        <!--Let browser know website is optimized for mobile-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <!--Favicon related-->
        <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../../../apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../../../apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../../../../../apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../../../apple-touch-icon-144x144.png" />
        <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../../../../../apple-touch-icon-60x60.png" />
        <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../../../../../apple-touch-icon-120x120.png" />
        <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../../../../../apple-touch-icon-76x76.png" />
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../../../apple-touch-icon-152x152.png" />
        <link rel="icon" type="image/png" href="../../../../../favicon-196x196.png" sizes="196x196" />
        <link rel="icon" type="image/png" href="../../../../../favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/png" href="../../../../../favicon-32x32.png" sizes="32x32" />
        <link rel="icon" type="image/png" href="../../../../../favicon-16x16.png" sizes="16x16" />
        <link rel="icon" type="image/png" href="../../../../../favicon-128.png" sizes="128x128" />
        <meta name="application-name" content="Pavel Shchegolevatykh's Blog'"/>
        <meta name="msapplication-TileColor" content="#FFFFFF" />
        <meta name="msapplication-TileImage" content="../../../../../mstile-144x144.png" />
        <meta name="msapplication-square70x70logo" content="../../../../../mstile-70x70.png" />
        <meta name="msapplication-square150x150logo" content="../../../../../mstile-150x150.png" />
        <meta name="msapplication-wide310x150logo" content="../../../../../mstile-310x150.png" />
        <meta name="msapplication-square310x310logo" content="../../../../../mstile-310x310.png" />
        <!--SEO-->
        <meta name="description" content="Pavel Shchegolevatykh is a software developer, who used to be in eSports. Writes about programming, lifestyle, gaming, hobbies and other topics.">
	    <meta name="author" content="Pavel Shchegolevatykh">
        <title>Pavel Shchegolevatykh - Programming, Lifestyle, Gaming, Hobbies, Random Thoughts</title>
    </head>

    <body>
        <nav class="white" role="navigation">
            <div class="nav-wrapper container">
                <ul class="left hide-on-med-and-down">
                    <li>
                        <a href="../../../../../">Home</a>
                    </li>
                    <li>
                        <a href="../../../../../about/">About</a>
                    </li>
                </ul>
                <ul id="nav-mobile" class="side-nav" style="transform: translateX(-100%);">
                    <li>
                        <a href="../../../../../">Home</a>
                    </li>
                    <li>
                        <a href="../../../../../about/">About</a>
                    </li>
                </ul>
                <a href="#" data-activates="nav-mobile" class="button-collapse">
                    <i class="material-icons">menu</i>
                </a>
            </div>
        </nav>
        <div class="container blog">
                <div class="row">
                    <div class="col s12">
                        <div id="post" class="section scrollspy blog-content">
                            <div class="row valign-wrapper">
                                <div class="col s2 m2 l1">
                                    <a href="../../../../../about/"><img src="../../../../../images/me.png" alt="Avatar" class="circle responsive-img"></a>
                                </div>
                                <div class="col s10 m10 l11">
                                    <span class="grey-text text-darken-1">
                                        By Pavel Shchegolevatykh / January 30, 2013
                                    </span>
                                </div>
                                    
                            </div>
                            <h4>PPPoE automation</h4>
                            <p>In my <a href="../../../../../posts/2013/01/29/connecting-via-pppoe/">previous</a> post I showed how to open PPPoE connection automatically at Windows startup. However there were still some issues. One of them is to find a way to keep this connection alive. After doing some research I came up with two ideas.</p>
                            <h5>Method 1 - Scheduled task</h5>
                            <p>1. Open Task Scheduler window from the control panel or type <strong>taskschd.msc</strong> in <strong>Run</strong> Menu and create a new task.</p>
                            <div class="center">
                                <img data-caption="Create task window" src="images/createtask.png">
                            </div>
                            <p>2. On <strong>General</strong> tab specify <strong>Name</strong> and <strong>Description</strong>. Also chose <strong>Run whether user is logged on or not</strong> option in order to run task in background.</p>
                            <div class="center">
                                <img data-caption="Create task window" src="images/crtask.png">
                            </div>
                            <p>3. On <strong>Triggers</strong> tab add a new trigger. Set <strong>Daily</strong> option and Repeat task every <strong>5 minutes</strong> for a duration of <strong>Indefinitely</strong>.</p>
                            <div class="center">
                                <img data-caption="Triggers window" src="images/triggers.png">
                            </div>
                            <p>4. On <strong>Actions</strong> tab add a new action. In <strong>Program/script</strong> text field type <strong>rasdial</strong>. In arguments specify your credentials: connection name, username and password separated by spaces. After that click <strong>OK</strong> in all windows.</p>
                            <div class="center">
                                <img data-caption="New action window" src="images/newaction.png">
                            </div>
                            <p>Then <strong>Task Scheduler</strong> asks you to provide your PC user credentials in order to continue. Please do that and we are all done with task creation.</p>
                            <div class="center">
                                <img data-caption="PC credentials window" src="images/credentials.png">
                            </div>
                            <p>You can test it by running manually or just wait for five minutes to see if it works. One obvious drawback is that we can only specify no less than five minutes timeout to reconnect. Maybe for some reason you need less than that. A good thing that user doesn't feel anything - no frightening command prompt or other dialogs. It works just like any other background process.</p>
                            <h5>Method 2 - Custom Windows Service</h5>
                            <p>As I said before for some reason you might need polling interval to be less than five minutes. For this purpose I implemented a Windows Service application that is fully configurable. You can set polling timeout and your connection details. It uses <strong>rasdial</strong> process internally. Works seemlessly. No annoying popups. Internal timer triggers polling for specified connection. <strong>If are to change something in xml config file you should restart the service.</strong> This file is located in the service application folder (<strong>Program Files</strong> by default). After the installation in order to run the service you can either restart your PC or run it manually using windows <strong>Services</strong> manager (<strong>services.msc</strong> using <strong>Run</strong> command).</p>
                            <div class="center">
                                <img data-caption="Services window" src="images/service.png">
                            </div>
                            <p><a href="https://www.dropbox.com/s/ezrcdrq404q4zss/PppoeConnectionDialerSetup.msi">Download PPPoE dialer service installer</a><br /><a href="https://github.com/PShchegolevatykh/pppoe-dialer">Source code</a></p>
                            <p>If you found this useful feel free to thank me in comments or share this post with others.</p>
                            <div class="right social-share">
                                <a href="https://www.facebook.com/sharer/sharer.php?u=http://www.pshchegolevatykh.com/posts/2013/01/30/pppoe-automation/" onclick="window.open(this.href,'_blank', 'width=700, height=500'); return false;"><i class="fa fa-facebook"></i></a>
                                <a href="https://twitter.com/intent/tweet?text=http://www.pshchegolevatykh.com/posts/2013/01/30/pppoe-automation/" onclick="window.open(this.href,'_blank', 'width=700, height=500'); return false;"><i class="fa fa-twitter"></i></a>
                                <a href="https://vk.com/share.php?url=http://www.pshchegolevatykh.com/posts/2013/01/30/pppoe-automation/" onclick="window.open(this.href,'_blank', 'width=700, height=500'); return false;"><i class="fa fa-vk"></i></a>
                                <a href="https://www.linkedin.com/shareArticle?url=http://www.pshchegolevatykh.com/posts/2013/01/30/pppoe-automation/" onclick="window.open(this.href,'_blank', 'width=700, height=500'); return false;"><i class="fa fa-linkedin"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            
            <div id="comments-section"><div id="disqus_thread"></div></div>
            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
        </div>
                                    

        <footer>
            <div class="footer-copyright">
                <div class="container">
                   <!-- footer text -->
                </div>
            </div>
        </footer>
        
        <!--Import jQuery before materialize.js-->
        <script type="text/javascript" src="https://use.fontawesome.com/061481d937.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script>if (!window.jQuery) { document.write('<script src="../../../../../js/jquery-2.1.1.min.js"><\/script>'); }</script>
        <script type="text/javascript" src="../../../../../js/materialize.min.js"></script>
        <script type="text/javascript" src="../../../../../js/site.js"></script>
        <script type="text/javascript" src="../../../../../js/prism.js"></script>
        <script>
            var disqus_config = function() {
                this.page.url = "http://www.pshchegolevatykh.com/posts/2013/01/30/pppoe-automation/"; // Replace PAGE_URL with your page's canonical URL variable
                this.page.identifier = "/posts/2013/01/30/pppoe-automation/"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
            };
            (function() { // DON'T EDIT BELOW THIS LINE
                var d = document,
                s = d.createElement('script');
                s.src = '//pshchegolevatykh.disqus.com/embed.js';
                s.setAttribute('data-timestamp', + new Date());
                (d.head || d.body).appendChild(s);
            })();
        </script>
        <!--Google Analytics-->
        <script>
            (function(i, s, o, g, r, a, m) {
                i['GoogleAnalyticsObject'] = r;
                i[r] = i[r] || function() {
                    (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
                a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m)
            })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

            ga('create', 'UA-86164699-1', 'auto');
            ga('send', 'pageview');
        </script>
    </body>
</html>